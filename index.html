<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>YouTube Premium</title>
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' rx='22' fill='%23f00'/><path d='M70 50L40 65V35z' fill='white'/></svg>">
    <script>
        // ========================================
        // ליבת טכנולוגיית חסימת הפרסומות של Brave
        // ========================================
        const adBlockLists = [
            "https://easylist.to/easylist/easylist.txt",
            "https://easylist.to/easylist/easyprivacy.txt",
            "https://secure.fanboy.co.nz/fanboy-annoyance.txt"
        ];
        
        let adBlockRules = [];
        
        // טעינת רשימות חסימה
        async function loadAdBlockLists() {
            try {
                for (const listUrl of adBlockLists) {
                    const response = await fetch(listUrl);
                    const text = await response.text();
                    const rules = text.split('\n')
                        .filter(line => line && !line.startsWith('!'))
                        .map(rule => {
                            // הסרת פרמטרים מיותרים
                            if (rule.includes('$')) return rule.split('$')[0];
                            return rule;
                        });
                    adBlockRules = [...adBlockRules, ...rules];
                }
                console.log(`טענת ${adBlockRules.length} כללי חסימה`);
            } catch (e) {
                console.error("שגיאה בטעינת רשימות חסימה:", e);
            }
        }
        
        // חסימת פרסומות בזמן אמת
        function blockAds() {
            // חסימת אלמנטים לפי CSS
            adBlockRules.filter(rule => rule.startsWith('##')).forEach(rule => {
                const selector = rule.substring(2);
                document.querySelectorAll(selector).forEach(el => el.remove());
            });
            
            // חסימת תעבורה
            const observer = new MutationObserver(mutations => {
                mutations.forEach(mutation => {
                    mutation.addedNodes.forEach(node => {
                        if (node.nodeType === 1 && node.tagName === 'SCRIPT') {
                            const src = node.src || '';
                            if (adBlockRules.some(rule => 
                                rule && src.includes(rule.replace('||', '').replace('^', ''))
                            ) {
                                node.remove();
                                console.log("חסימת סקריפט פרסומות:", src);
                            }
                        }
                    });
                });
            });
            
            observer.observe(document.documentElement, {
                childList: true,
                subtree: true
            });
        }
        
        // ========================================
        // טכנולוגיית הרצה ברקע
        // ========================================
        function enableBackgroundPlay() {
            // הפעלת Picture-in-Picture
            const enablePiP = () => {
                const videos = document.querySelectorAll('video');
                videos.forEach(video => {
                    if (!document.pictureInPictureElement) {
                        video.requestPictureInPicture().catch(e => {
                            // טריק לגרום לווידאו להמשיך לנגן ברקע
                            video.setAttribute('playsinline', '');
                            video.setAttribute('webkit-playsinline', '');
                            video.play();
                        });
                    }
                });
            };
            
            // האזנה לשינויים בדף
            const observer = new MutationObserver(mutations => {
                if (document.querySelector('video')) {
                    enablePiP();
                    observer.disconnect();
                }
            });
            
            observer.observe(document.body, {
                childList: true,
                subtree: true
            });
            
            // הפעלה אוטומטית כשהדף נטען
            window.addEventListener('load', enablePiP);
        }
        
        // ========================================
        // אתחול המערכת
        // ========================================
        window.onload = async function() {
            // אם אנחנו ב-PWA, פתח ישירות את יוטיוב
            if (window.navigator.standalone) {
                await loadAdBlockLists();
                window.location.href = "https://www.youtube.com";
            } else {
                // הצג הוראות התקנה
                document.getElementById('instructions').style.display = 'block';
                
                // טען רשימות חסימה
                await loadAdBlockLists();
                
                // פתח את יוטיוב
                window.location.href = "https://www.youtube.com";
            }
        };
        
        // הפעל את טכנולוגיות הליבה כשהדף נטען
        window.addEventListener('DOMContentLoaded', () => {
            if (window.navigator.standalone) {
                setTimeout(() => {
                    blockAds();
                    enableBackgroundPlay();
                }, 3000);
            }
        });
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0f0f0f 0%, #1a1a1a 100%);
            color: white;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 20px;
        }
        
        .logo {
            width: 100px;
            height: 100px;
            margin: 0 auto 20px;
            background: #ff0000;
            border-radius: 22px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 30px rgba(255, 0, 0, 0.5);
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); box-shadow: 0 0 40px rgba(255, 0, 0, 0.7); }
        }
        
        .logo svg {
            width: 60px;
            height: 60px;
            fill: white;
        }
        
        h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
            color: #fff;
            font-weight: 700;
            background: linear-gradient(45deg, #ff0000, #ff5a5a);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .subtitle {
            color: #aaa;
            font-size: 1.1rem;
            margin-bottom: 30px;
        }
        
        .instructions {
            margin-top: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            text-align: center;
            max-width: 500px;
            width: 100%;
            display: none;
            animation: fadeIn 1s forwards;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .instructions h3 {
            color: #ff5a5a;
            margin-bottom: 15px;
            font-size: 1.4rem;
        }
        
        .instructions ol {
            text-align: right;
            padding-right: 20px;
            list-style-position: inside;
        }
        
        .instructions li {
            margin-bottom: 10px;
            line-height: 1.8;
            font-size: 1.1rem;
        }
        
        .loading {
            margin-top: 30px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(255, 255, 255, 0.1);
            border-top: 5px solid #ff0000;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .tech-features {
            margin-top: 30px;
            text-align: right;
            max-width: 500px;
        }
        
        .tech-features h3 {
            color: #ff5a5a;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }
        
        .feature-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .feature-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }
        
        .feature-text {
            font-size: 1rem;
        }
    </style>
</head>
<body>
    <div class="logo">
        <svg viewBox="0 0 24 24">
            <path d="M23.498 6.186a2.998 2.998 0 0 0-2.112-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.386.505A2.998 2.998 0 0 0 .502 6.186C0 8.067 0 12 0 12s0 3.933.502 5.814a2.998 2.998 0 0 0 2.112 2.136c1.881.505 9.386.505 9.386.505s7.505 0 9.386-.505a2.998 2.998 0 0 0 2.112-2.136C24 15.933 24 12 24 12s0-3.933-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/>
        </svg>
    </div>
    
    <h1>YouTube Premium</h1>
    <p class="subtitle">טכנולוגיות חסימת פרסומות והרצה ברקע</p>
    
    <div class="loading">
        <div class="spinner"></div>
        <p class="subtitle">מכין את טכנולוגיות הליבה...</p>
    </div>
    
    <div class="tech-features">
        <h3>טכנולוגיות מובנות:</h3>
        <div class="feature-item">
            <div class="feature-icon">🛡️</div>
            <div class="feature-text">חסימת פרסומות בזמן אמת</div>
        </div>
        <div class="feature-item">
            <div class="feature-icon">🎧</div>
            <div class="feature-text">הרצת וידאו ברקע</div>
        </div>
        <div class="feature-item">
            <div class="feature-icon">⚡</div>
            <div class="feature-text">ביצועים גבוהים</div>
        </div>
    </div>
    
    <div class="instructions" id="instructions">
        <h3>לחוויה מלאה:</h3>
        <ol>
            <li>פתח את יוטיוב בלחיצה על הקישור</li>
            <li>לחץ על סמל השיתוף (חץ למעלה)</li>
            <li>בחר "הוסף למסך הבית"</li>
            <li>בפעם הבאה - פתח ישירות מהאפליקציה במסך הבית!</li>
        </ol>
    </div>

    <script>
        // ויברציה קלה כשהדף נטען
        if (navigator.vibrate) {
            navigator.vibrate(20);
        }
        
        // אם אנחנו לא ב-PWA, נציג הוראות התקנה אחרי זמן קצר
        if (!window.navigator.standalone) {
            setTimeout(() => {
                document.getElementById('instructions').style.display = 'block';
            }, 1500);
        }
    </script>
</body>
</html>
