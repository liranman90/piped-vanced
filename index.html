<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <title>YouTube Premium</title>
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' rx='22' fill='%23f00'/><path d='M70 50L40 65V35z' fill='white'/></svg>">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
        }
        
        body, html {
            height: 100%;
            overflow: hidden;
            background: #000;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            color: white;
            padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
        }
        
        #container {
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 20px;
            position: relative;
        }
        
        .logo {
            width: 100px;
            height: 100px;
            margin-bottom: 25px;
            background: #ff0000;
            border-radius: 22px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 30px rgba(255, 0, 0, 0.5);
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); box-shadow: 0 0 40px rgba(255, 0, 0, 0.7); }
        }
        
        .logo svg {
            width: 60px;
            height: 60px;
            fill: white;
        }
        
        h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
            font-weight: 700;
            background: linear-gradient(45deg, #ff0000, #ff5a5a);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .subtitle {
            color: #aaa;
            font-size: 1.1rem;
            margin-bottom: 30px;
        }
        
        .features {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 30px;
            max-width: 400px;
            width: 100%;
        }
        
        .feature {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
        }
        
        .feature-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }
        
        .feature-text {
            font-size: 0.9rem;
            color: #ddd;
        }
        
        .progress-container {
            width: 100%;
            max-width: 300px;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin: 20px auto;
        }
        
        .progress-bar {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #ff0000, #ff5a5a);
            border-radius: 4px;
            animation: progress 2s forwards;
        }
        
        @keyframes progress {
            to { width: 100%; }
        }
        
        .status {
            color: #ccc;
            font-size: 1rem;
            margin-top: 20px;
        }
        
        .instructions {
            margin-top: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            text-align: center;
            max-width: 500px;
            width: 100%;
            display: none;
        }
        
        .instructions h3 {
            color: #ff5a5a;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }
        
        .instructions ol {
            text-align: right;
            padding-right: 20px;
            list-style-position: inside;
        }
        
        .instructions li {
            margin-bottom: 10px;
            line-height: 1.5;
        }
        
        /* הסתרת סרגלי הניווט במצב PWA */
        @media (display-mode: standalone) {
            body {
                padding-top: env(safe-area-inset-top);
                padding-bottom: env(safe-area-inset-bottom);
            }
            
            body::after {
                content: "";
                display: block;
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                height: env(safe-area-inset-top);
                background: #000;
                z-index: 1000;
            }
            
            .instructions {
                display: none !important;
            }
        }
    </style>
</head>
<body>
    <div id="container">
        <div class="logo">
            <svg viewBox="0 0 24 24">
                <path d="M23.498 6.186a2.998 2.998 0 0 0-2.112-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.386.505A2.998 2.998 0 0 0 .502 6.186C0 8.067 0 12 0 12s0 3.933.502 5.814a2.998 2.998 0 0 0 2.112 2.136c1.881.505 9.386.505 9.386.505s7.505 0 9.386-.505a2.998 2.998 0 0 0 2.112-2.136C24 15.933 24 12 24 12s0-3.933-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/>
            </svg>
        </div>
        
        <h1>YouTube Premium</h1>
        <p class="subtitle">ללא פרסומות • הרצה ברקע • מסך מלא</p>
        
        <div class="features">
            <div class="feature">
                <div class="feature-icon">🚫</div>
                <div class="feature-text">ללא פרסומות</div>
            </div>
            <div class="feature">
                <div class="feature-icon">🎧</div>
                <div class="feature-text">הרצה ברקע</div>
            </div>
            <div class="feature">
                <div class="feature-icon">📱</div>
                <div class="feature-text">מסך מלא</div>
            </div>
            <div class="feature">
                <div class="feature-icon">⚡</div>
                <div class="feature-text">מהיר ויציב</div>
            </div>
        </div>
        
        <div class="progress-container">
            <div class="progress-bar"></div>
        </div>
        
        <div class="status" id="statusText">מתחיל טעינה...</div>
        
        <div class="instructions" id="instructions">
            <h3>הוראות להתקנה מלאה:</h3>
            <ol>
                <li>פתח את יוטיוב בלחיצה על הקישור</li>
                <li>לחץ על סמל השיתוף (חץ למעלה)</li>
                <li>בחר "הוסף למסך הבית"</li>
                <li>בפעם הבאה - פתח ישירות מהאפליקציה במסך הבית!</li>
            </ol>
        </div>
    </div>

    <script>
        // רשימת שרתי פרוקסי פעילים לחסימת פרסומות
        const PROXY_SERVERS = [
            "https://vid.puffyan.us",
            "https://inv.riverside.rocks",
            "https://invidious.snopyta.org",
            "https://yewtu.be"
        ];
        
        // מציאת שרת זמין
        async function findWorkingProxy() {
            for (const proxy of PROXY_SERVERS) {
                try {
                    const response = await fetch(`${proxy}/healthcheck`, {
                        method: 'HEAD',
                        mode: 'no-cors',
                        cache: 'no-store'
                    });
                    return proxy;
                } catch (e) {
                    continue;
                }
            }
            return null;
        }
        
        // הפעלת הרצה ברקע
        function enableBackgroundPlay() {
            const videos = document.querySelectorAll('video');
            videos.forEach(video => {
                // הפעלת Picture-in-Picture
                video.requestPictureInPicture().catch(() => {
                    // גיבוי להרצה ברקע
                    video.setAttribute('playsinline', '');
                    video.setAttribute('webkit-playsinline', '');
                    video.play();
                });
            });
        }
        
        // פתיחת YouTube
        async function openYouTube() {
            const statusEl = document.getElementById('statusText');
            
            try {
                // מציאת שרת פרוקסי זמין
                statusEl.textContent = "מחפש שרת ללא פרסומות...";
                const proxy = await findWorkingProxy();
                
                if (!proxy) {
                    statusEl.textContent = "משתמש ב-YouTube רגיל";
                    window.location.href = "https://www.youtube.com";
                    return;
                }
                
                statusEl.textContent = "פותח יוטיוב ללא פרסומות...";
                
                // אם אנחנו ב-PWA, פתח ישירות
                if (window.matchMedia('(display-mode: standalone)').matches) {
                    window.location.href = `${proxy}`;
                } else {
                    // פתיחה בחלון חדש
                    const newWindow = window.open("", "_blank");
                    
                    // יצירת דף חדש עם החסימות
                    newWindow.document.write(`
                        <!DOCTYPE html>
                        <html>
                        <head>
                            <meta name="viewport" content="width=device-width, initial-scale=1.0">
                            <meta name="apple-mobile-web-app-capable" content="yes">
                            <meta name="apple-mobile-web-app-status-bar-style" content="black">
                            <title>YouTube Premium</title>
                            <style>
                                body, html {
                                    margin: 0;
                                    padding: 0;
                                    height: 100%;
                                    overflow: hidden;
                                    background: #000;
                                }
                                iframe {
                                    position: fixed;
                                    top: 0;
                                    left: 0;
                                    width: 100%;
                                    height: 100%;
                                    border: none;
                                }
                            </style>
                        </head>
                        <body>
                            <iframe src="${proxy}" allowfullscreen></iframe>
                            <script>
                                // הפעלת הרצה ברקע
                                setTimeout(() => {
                                    const videos = document.querySelectorAll('video');
                                    videos.forEach(video => {
                                        video.requestPictureInPicture().catch(() => {
                                            video.setAttribute('playsinline', '');
                                            video.setAttribute('webkit-playsinline', '');
                                            video.play();
                                        });
                                    });
                                }, 3000);
                            <\/script>
                        </body>
                        </html>
                    `);
                    newWindow.document.close();
                }
                
            } catch (e) {
                statusEl.textContent = "פותח גרסה רגילה...";
                window.location.href = "https://www.youtube.com";
            }
        }
        
        // אתחול המערכת
        window.onload = async function() {
            // הצג הוראות אם לא במצב PWA
            if (!window.matchMedia('(display-mode: standalone)').matches) {
                document.getElementById('instructions').style.display = 'block';
            }
            
            // הפעל את YouTube
            setTimeout(openYouTube, 2000);
        };
    </script>
</body>
</html>
